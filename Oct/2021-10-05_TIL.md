# ğŸ“‘Today I Learn (2021.10.95)

<br>

## **Django**

<br>

## â—† ***ì˜¤ëŠ˜ ë°°ìš°ê³  ì •ë¦¬í•œ ëª©ì°¨***
1. from django.db import Q
2. migration
3. Dateê´€ë ¨ model

<br>

<br>

## ğŸ” ***from django.db import Q***
ì¸ìŠ¤íƒ€ê·¸ë¨ í´ë¡  ì½”ë”©ì„ í•˜ë©´ì„œ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•˜ëŠ”ë° Që¥¼ ì•Œê²Œ ëë‹¤.

QëŠ” ì¥ê³  model ormìœ¼ë¡œ where ì ˆì— orë¬¸ì„ ì¶”ê°€í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•œë‹¤.

1) or ì¡°ê±´
```python
from django.db.models import Q

post_list = Post.objects.all()\
        .filter(
            Q(author=request.user) | Q(author__in=request.user.following_set.all())
        )\
        .filter(
            create_at__gte=timesince
        )
```
`author__in` : ë’¤ì˜ ì¡°ê±´ì´ í¬í•¨ëœ author

`gte` : greater than 

2) and ì¡°ê±´
```python
Post.objects.filter(Q(username='user14') & Q(id=1))
```

3) Qì¡°ê±´ ì—°ê²°
```python
q = Q(id=99)
q.add(naem='í™ê¸¸ë™', q.OR)
#ì¶œë ¥ : id=99 or name="í™ê¸¸ë™"
```

<br>

<br>

## ğŸ” ***migration***
ì–¸ì œ ì“°ëŠ”ê°€? models.pyë‚´ì—ì„œ ëª¨ë¸ ìƒì„±/ë³€ê²½ì— ëŒ€í•œ ê¸°ë¡ê´€ë¦¬ì™€, 

ì •ì˜í•œ ëª¨ë¸ì„ DBì— ì ìš©í•˜ê¸° ìœ„ì— migration ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.

<br>

#### 1) ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ìƒì„±

**$ python manage.py makemigrations app_name**

![image](https://user-images.githubusercontent.com/83274792/136055783-12fcd32f-2622-42ca-a04b-13cdafe88aae.png)

<br>

#### 2) ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì ìš©

**$ python manage.py migrate app_name**

![image](https://user-images.githubusercontent.com/83274792/136055806-64245ecb-ae57-4f62-b0b9-a6f23484f6ff.png)

<br>

#### 3) í˜„ì¬ ì ìš©ëœ ë§ˆì´ê·¸ë ˆì´ì…˜ í™•ì¸

**$ python manage.py showmigrations app_name**

![image](https://user-images.githubusercontent.com/83274792/136055831-63aba1a2-736b-432d-a317-a14fcc390c57.png)

<br>

#### 4) ë§ˆì´ê·¸ë ˆì´ì…˜ ë˜ëŒë¦¬ê¸°
**$ python manage.py migrate app_name 000Y**

![image](https://user-images.githubusercontent.com/83274792/136055932-92cc1dbb-1dbb-4fad-887b-8c7e555d0a24.png)

<br>

#### 5) í˜„ì¬ ë°”ë€ ë§ˆì´ê·¸ë ˆì´ì…˜ì˜ SQL
**$ python manage.py sqlmigrate app_name 000X**

ì–´ë–¤ í…Œì´ë¸”ì´ ìƒì„±ëëŠ”ì§€ ë³¼ ìˆ˜ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![image](https://user-images.githubusercontent.com/83274792/136057202-7176d27c-cd75-460d-80b9-b5ee1d115513.png)


<br>

ì¢…ì¢… migrationì„ í•  ë•Œ ì•„ë˜ì™€ ê°™ì€ í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

![image](https://user-images.githubusercontent.com/83274792/136056564-1999033f-0a83-4375-9983-6dfe63cc85ca.png)

blankì¡°ê±´ê³¼ nullì¡°ê±´ì´ ì—†ëŠ” í•„ìˆ˜ í•„ë“œì— ëŒ€í•´ì„œ ì–´ë–¤ê°’ì„ ë„£ì„ì§€ ë¬¼ì–´ë³´ëŠ” ê±°ë¼ê³  í•œë‹¤. 

1ë²ˆì„ ì„ íƒí•˜ë©´ ì§€ê¸ˆ ê°œë°œìê°€ defaultê°’ì„ ì •í•˜ëŠ” ê²ƒì´ê³ , 2ë²ˆì„ ëˆ„ë¥´ë©´ ì¢…ë£Œëœë‹¤.

1ë²ˆì„ ëˆ„ë¥´ë©´ ì•„ë˜ì˜ ê·¸ë¦¼ ì²˜ëŸ¼ default ê°’ìœ¼ë¡œ `timezone.now`ë¥¼ ì¶”ì²œí•´ì¤€ë‹¤. 

(í•´ë‹¹ í•„ë“œê°€ ë‚ ì§œ ê´€ë ¨ í•„ë“œë¼ ê·¸ëŸ°ê±°ê°™ë‹¤.)

![image](https://user-images.githubusercontent.com/83274792/136056974-694f86ef-1eb2-4871-9bb3-8dd571d35cd3.png)
`timezone.now` : í˜„ì¬ ì‹œê°„ì´ í•œë²ˆì— ë™ì¼í•˜ê²Œ ë“¤ì–´ê°

<br>

<br>

## ğŸ’¡ Dateê´€ë ¨ model
```python
class BaseModel(models.Model):
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True
```
ìœ„ì˜ ì˜ˆì‹œì¸ BaseModelì€ ì‹¤ì œë¡œ DBì— í…Œì´ë¸” ìƒì„±ì€ ì•ˆëœë‹¤. ë”°ë¼ì„œ migration ëŒ€ìƒì€ ì—†ë‹¤.

í•˜ì§€ë§Œ ë¶€ëª¨classë¡œ ì‚¬ìš©ì€ ê°€ëŠ¥í•˜ë‹¤. ì´ë ‡ê²Œ ëª¨ë¸ì„ ì •ì˜í•˜ê²Œ ë˜ë©´ ë‹¤ë¥¸ ëª¨ë¸ì—ì„œ ì‚¬ìš©í• ìˆ˜ 

ìˆëŠ” ì¥ì ì´ ì¡´ì¬í•œë‹¤.

<br>

<br>

## ğŸ“ŒSummary

<br>

<br>